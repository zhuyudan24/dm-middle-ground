webpackJsonp([7],{"5RkF":function(e,t,a){"use strict";var r={name:"breadcrumb",data:function(){return{curitem:0}},props:{activeitem:{type:Number,default:0},navpath:{type:Array,default:function(){return[]}},navtab:{type:Array,default:function(){return[]}},navpathName:{type:String,default:""}},watch:{activeitem:function(e,t){this.curitem=e}},methods:{changeTab:function(e){this.curitem=e.tab,this.$emit("getCurTab",e.tab)}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"navwrap"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("span",{staticClass:"el-breadcrumb__item no-link link-active"},[a("i",{staticClass:"iconfont icon-shouye"}),a("router-link",{staticClass:"el-breadcrumb__inner is-link",attrs:{to:"/index"}},[e._v("首页")]),a("span",{staticClass:"el-breadcrumb__separator",attrs:{role:"presentation"}},[e._v("/")])],1),e._v(" "),e._l(e.navpath,function(t,r){return a("el-breadcrumb-item",{key:r,staticClass:"no-link",class:{"link-active":""!=t.path},attrs:{to:{path:t.path}}},[e._v(e._s(t.name))])})],2),e._v(" "),a("div",{staticClass:"clearfix"},[a("h1",{staticClass:"navtitle fl"},[e._v(e._s(e.navpathName))]),e._v(" "),a("el-row",{staticClass:"nav-double-btn fr"},e._l(e.navtab,function(t,r){return a("el-button",{key:r,class:e.curitem==t.tab?"on":"",on:{click:function(a){return e.changeTab(t)}}},[e._v(e._s(t.name))])}),1)],1)],1)},staticRenderFns:[]};var n=a("C7Lr")(r,s,!1,function(e){a("6Unb")},"data-v-812a329c",null);t.a=n.exports},"6Unb":function(e,t){},"8Td+":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MkZBQTNFQjQ4RDkzMTFFODk5QUY5MEYyNDkzRDE2ODIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MkZBQTNFQjU4RDkzMTFFODk5QUY5MEYyNDkzRDE2ODIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5MDc3MUI4OThENUQxMUU4OTlBRjkwRjI0OTNEMTY4MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5MDc3MUI4QThENUQxMUU4OTlBRjkwRjI0OTNEMTY4MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoVF8H0AAAOnSURBVHja7Jvba9NQHMdP0iRNsy0ddjd0OnFOJiIo6pOo+OSDKAoiQ8XLk1d88S8Q55PPCvPJCYI+Koj65A3RFxGc4gZSEHQXt7m1nTW9JX5Pm0HWbbFuPUna5gcfTtrSQ775nd/v/M5JwhmGQazGcRwp1Z4PJkJoRsHOvd0Nn4iHrFjXrPHL7DcIVNBEKsS4pXgYnu1GsxH8BmdAP5DBGDz91sseFpbY3zFwGcyAdeA2OAS+gu1V52GLp6lXh8A+eHawFmKYCl4D2iolhoVl/p/G8DMQdVvIt8m0iOYmqAMXQGxR11upVIPgXcAw6SnWNYtAqsc+gvdAAa+ZJC0vG6ukVXEmlDmOetD0lrtfG5sABzsi0rArgmFHQaeDDusAO8DDUv9Q7iHtRohwXj/ByothlJRb0TwBrdbvo+MppifLw5etYZGERN7xIXiiWKwTpmOmSWi6KzEX8Nr86sewL9gX7AuuHcGapqlgM5CqXjBEHkAzbK4vo/jcXe0evgW+mMUF/f16tZeWq8B9WZbvwbvncbzWroMmVST1QbapIJU1yMhUmpngp+AKxB4xxV61LblQ3woBtrskOd1g6uHjpshNoA/csOtgLJbJU7FDGkN5ihTuKvjzsC+4VjYArCYJHJFFttctnTOIlta9IbglLDIXTJN0dEzzhuCJeJYoDszDnhnSWkbP4yctF6z/1XcZnKsJwRBK71OfBUEcX6oFD9PbLm9MTS+ZxfCKeoHUyWw3MdPIEf8qX0/tbk/Cs3RJ24njgZNlfqhlzjwcFNguHrgSByKE0iXVA6ZZenQ6Q3g+y3Ye1j00LZX7hPxpyRfs8pAO8Fw+cbG0LBYPmZzhDcFtjSIJSYwXD8gR0Z8pbwiOJXN5D9TM4mFGy+Xxk5YvuMKyNOrU02goZGQysZ7n2V0rRRZJQ0hyVzApbMrvoQeZnE53x5kJlsSAP6TtJgpWHnauYLZ5cAUFyDtSuCNC7Rd4wUrwkFN601nd5jfjcUdEuuPEkH5ECu8oMbdUJgthC87ttNy6yzyG4/F4+PAWdXVXi9SL0nnGCdHj08li0XpEIX3bVhrtOJ8uoCxpM2GxB8TR4X4010jh/STZMqTIDyz6YxpCjWO900FIXVAgCmr1iGIQeX4A0os/AC6qqvphbhow/k+wKboZzQZSuEnebGkbAX0Nrx40mBeEvlyhFo2acClrA5CwLo5MIfS7PyBpZmJ662HaDKtZRsBniE3Mz3sLC/4rwADdgm5QNzjziAAAAABJRU5ErkJggg=="},Ryvk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("3cXf"),s=a.n(r),n=a("5RkF"),i=a("P9l9"),o=a("0xDb"),l={name:"index",data:function(){return{navpath:[],navpathName:"用户管理",navtab:[{name:"用户列表",tab:0},{name:"角色列表",tab:1}],activeitem:0,tableData1:[],tableData2:[],totalCount1:0,totalCount2:0,currentPage1:1,currentPage2:1,searchUser:"",searchRole:"",projectCode:"",applyList:[],loading:!1}},computed:{},mounted:function(){this.getSesionData()},methods:{getSesionData:function(){var e=sessionStorage.getItem("activeitem");if(e)if(this.activeitem=parseInt(e),0==this.activeitem){var t=JSON.parse(sessionStorage.getItem("userData"));t&&(this.searchUser=t.searchUser,this.getUserList())}else{var a=JSON.parse(sessionStorage.getItem("roleData"));a&&(this.searchRole=a.searchRole,this.projectCode=a.projectCode,this.getAllThree(),this.getRoleList())}else this.getUserList()},getCurTab:function(e){this.activeitem=e,0==e&&this.getUserList(),1==e&&(this.getAllThree(),this.getRoleList())},getUserList:function(){var e=this;this.loading=!0;var t={search:this.searchUser,currentPage:this.currentPage1,pageSize:20};Object(i.b)("/api-admin/list-middle-user",t).then(function(t){var a=t.data;if(e.loading=!1,0==a.errorCode){var r=a.result.result;r&&r.length>0?(e.tableData1=r,e.totalCount1=a.result.totalCount):(e.tableData1=[],e.totalCount1=0),sessionStorage.removeItem("userData"),sessionStorage.removeItem("activeitem")}else e.$message.error(a.message)}).catch(function(e){Object(o.a)(e)})},searchUserList:function(){this.currentPage1=1,this.getUserList()},deleteUser:function(e,t){var a=this,r={clerkId:e};Object(i.b)("/api-admin/del-middle-user",r).then(function(e){var r=e.data;0==r.errorCode?(a.$message.success("删除成功"),a.totalCount1--,a.tableData1.splice(t,1),0==a.tableData1.length&&a.currentPage1>1&&(a.currentPage1=a.currentPage1-1,a.getUserList())):a.$message.error(r.message)}).catch(function(e){Object(o.a)(e)})},getAllThree:function(){var e=this;Object(i.b)("/api-admin/list-all-project",{}).then(function(t){var a=t.data;0==a.errorCode?(e.applyList=[{code:"",name:"所有应用"},{code:"gic",name:"GIC商户后台"}],a.result.forEach(function(t){"yueshi"!=t.code&&e.applyList.push(t)})):e.$message.error(a.message)}).catch(function(e){Object(o.a)(e)})},getRoleList:function(){var e=this;this.loading=!0;var t={search:this.searchRole,currentPage:this.currentPage2,pageSize:20,projectCode:this.projectCode};Object(i.b)("/api-admin/list-middle-role",t).then(function(t){var a=t.data;if(e.loading=!1,0==a.errorCode){var r=a.result.result;r&&r.length>0?(e.tableData2=r,e.totalCount2=a.result.totalCount):(e.tableData2=[],e.totalCount2=0),sessionStorage.removeItem("roleData"),sessionStorage.removeItem("activeitem")}else e.$message.error(a.message)}).catch(function(e){Object(o.a)(e)})},searchRoleList:function(){this.currentPage2=1,this.getRoleList()},changeApply:function(e){this.projectCode=e,this.currentPage2=1,this.getRoleList()},deleteRole:function(e,t){var a=this,r={roleId:e};Object(i.b)("/api-admin/delete-middle-role",r).then(function(e){var r=e.data;0==r.errorCode?(a.$message.success("删除成功"),a.totalCount2--,a.tableData2.splice(t,1),0==a.tableData2.length&&a.currentPage2>1&&(a.currentPage1=a.currentPage1-1,a.getRoleList())):a.$message.error(r.message)}).catch(function(e){Object(o.a)(e)})},handleCurrentChange1:function(e){this.currentPage1=e,this.getUserList()},handleCurrentChange2:function(e){this.currentPage2=e,this.getRoleList()},addUser:function(){this.$router.push("/addUser")},editUser:function(e){this.$router.push({path:"/editUser",query:{clerkId:e}})},editRole:function(e,t){this.$router.push({path:"/addRole",query:{roleId:e,type:1}})},addRole:function(){this.$router.push({path:"/addRole",query:{type:1}})},resetPaw:function(e){var t=this,a="确认重置【"+e.clerkName+"】的密码？新生成的密码将以短信的方式发给该用户";this.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,type:"warning"}).then(function(){var a={userId:e.clerkId};Object(i.b)("/api-admin/reset-middle-password",a).then(function(e){var a=e.data;0==a.errorCode?t.$message.success("重置密码成功"):t.$message.error(a.message)}).catch(function(e){Object(o.a)(e)})}).catch(function(){t.$message.info("已取消")})}},beforeRouteLeave:function(e,t,a){var r=e;if("/addRole"==r.path){var n={};n.searchRole=this.searchRole,n.projectCode=this.projectCode,n.currentPage2=this.currentPage2,sessionStorage.setItem("activeitem",this.activeitem),sessionStorage.setItem("roleData",s()(n))}else if("/addUser"==r.path||"/editUser"==r.path){var i={};i.searchUser=this.searchUser,i.currentPage1=this.currentPage1,sessionStorage.setItem("activeitem",this.activeitem),sessionStorage.setItem("userData",s()(i))}else sessionStorage.removeItem("activeitem");a()},components:{breadCrumbBtn:n.a}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"index-content"},[r("breadCrumbBtn",{attrs:{activeitem:e.activeitem,navpath:e.navpath,navpathName:e.navpathName,navtab:e.navtab},on:{getCurTab:e.getCurTab}}),e._v(" "),r("div",{staticClass:"content-content-wrap"},[r("div",{staticClass:"content-content"},[r("div",{directives:[{name:"show",rawName:"v-show",value:0==e.activeitem,expression:"activeitem == 0"}],staticClass:"user-list-wrap"},[r("div",{staticClass:"search-wrap"},[r("el-input",{staticClass:"search",attrs:{placeholder:"输入姓名/手机号码进行搜索","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUserList(t)}},model:{value:e.searchUser,callback:function(t){e.searchUser=t},expression:"searchUser"}}),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("新增用户")])],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-no-line-wrap",staticStyle:{width:"100%"},attrs:{data:e.tableData1}},[r("el-table-column",{attrs:{prop:"clerkName",label:"姓名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phoneNumber",label:"手机号码"}}),e._v(" "),r("el-table-column",{attrs:{prop:"roleName",label:"角色","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{staticClass:"role-name"},[e._v(e._s(t.row.roleName?t.row.roleName:"--"))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"storeCount",label:"管辖门店数",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"opr",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(a){return e.resetPaw(t.row)}}},[e._v("重置密码")]),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editUser(t.row.clerkId)}}},[e._v("编辑")]),e._v(" "),r("delete-tip",{attrs:{tips:"确定删除该用户?"},on:{confirm:function(a){return e.deleteUser(t.row.clerkId,t.$index)}}},[r("el-button",{attrs:{type:"text"}},[e._v("删除")])],1)]}}])}),e._v(" "),r("template",{slot:"empty"},[r("div",{staticClass:"no-data-wrap"},[r("div",{staticClass:"no-data-icon"},[r("img",{attrs:{src:a("8Td+"),alt:""}})]),e._v(" "),r("p",[e._v("暂无数据")])])])],2),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.totalCount1>0,expression:"totalCount1 > 0"}],staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":20,total:e.totalCount1},on:{"current-change":e.handleCurrentChange1}})],1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:1==e.activeitem,expression:"activeitem == 1"}],staticClass:"user-list-wrap"},[r("div",{staticClass:"search-wrap"},[r("el-input",{staticClass:"search",attrs:{placeholder:"输入角色名称进行搜索","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchRoleList(t)}},model:{value:e.searchRole,callback:function(t){e.searchRole=t},expression:"searchRole"}}),e._v(" "),r("el-select",{attrs:{placeholder:"请选择应用"},on:{change:e.changeApply},model:{value:e.projectCode,callback:function(t){e.projectCode=t},expression:"projectCode"}},e._l(e.applyList,function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1),e._v(" "),r("el-button",{staticStyle:{"margin-left":"16px"},attrs:{type:"primary"},on:{click:e.addRole}},[e._v("新增角色")])],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-no-line-wrap",staticStyle:{width:"100%"},attrs:{data:e.tableData2}},[r("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userCount",label:"账号数量"}}),e._v(" "),r("el-table-column",{attrs:{prop:"project",label:"角色所属应用"}}),e._v(" "),r("el-table-column",{attrs:{prop:"opr",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editRole(t.row.roleId,t.row.project)}}},[e._v("编辑")]),e._v(" "),r("delete-tip",{attrs:{tips:"确定删除该角色?"},on:{confirm:function(a){return e.deleteRole(t.row.roleId,t.$index)}}},[r("el-button",{attrs:{type:"text"}},[e._v("删除")])],1)]}}])}),e._v(" "),r("template",{slot:"empty"},[r("div",{staticClass:"no-data-wrap"},[r("div",{staticClass:"no-data-icon"},[r("img",{attrs:{src:a("8Td+"),alt:""}})]),e._v(" "),r("p",[e._v("暂无数据")])])])],2),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.totalCount2>0,expression:"totalCount2 > 0"}],staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":20,total:e.totalCount2},on:{"current-change":e.handleCurrentChange2}})],1)],1)])])],1)},staticRenderFns:[]};var u=a("C7Lr")(l,c,!1,function(e){a("q3yg")},"data-v-109bce45",null);t.default=u.exports},q3yg:function(e,t){}});